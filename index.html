<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<title>USDT æ”¯ä»˜</title>
<script src="config.js"></script>
<style>
body{font-family:Arial;background:#f5f6f8;padding:40px}
.box{background:#fff;padding:20px;max-width:420px;margin:auto}
button{padding:10px 20px;background:#2563eb;color:#fff;border:0}
</style>
</head>
<body>

<div class="box">
  <h2>USDT æ”¯ä»˜</h2>
  <p>é‡‘é¢ï¼š<span id="amount">100</span> USDT</p>
  <p>ç½‘ç»œï¼šTRC20</p>
  <button onclick="pay()">ç¡®è®¤æ”¯ä»˜</button>
</div>

<script>
function pay() {
  const orders = JSON.parse(localStorage.getItem('orders') || '[]');
  const agents = JSON.parse(localStorage.getItem('agents') || '{}');

  const orderId = 'U' + Date.now();

  const order = {
    id: orderId,
    amount: 100,
    network: 'TRC20',
    status: 'pending',
    time: new Date().toLocaleString(),
    agentPath: ['A001','A002'] // ç¤ºä¾‹ï¼šä¸€çº§ã€äºŒçº§ä»£ç†
  };

  orders.push(order);
  localStorage.setItem('orders', JSON.stringify(orders));

  // ğŸ”„ æ¨¡æ‹Ÿé“¾ä¸Šç›‘å¬ï¼ˆå¯æ¢çœŸ TRON APIï¼‰
  setTimeout(() => {
    const list = JSON.parse(localStorage.getItem('orders'));
    const o = list.find(i => i.id === orderId);
    o.status = 'success';

    // åˆ†æ¶¦
    o.agentPath.forEach((aid, idx) => {
      const rate = CONFIG.agentLevels[idx] || 0;
      agents[aid] = (agents[aid] || 0) + o.amount * rate;
    });

    localStorage.setItem('orders', JSON.stringify(list));
    localStorage.setItem('agents', JSON.stringify(agents));
  }, CONFIG.listenDelay);

  alert('è®¢å•å·²åˆ›å»ºï¼Œç­‰å¾…é“¾ä¸Šç¡®è®¤');
}
</script>
</body>
</html>
